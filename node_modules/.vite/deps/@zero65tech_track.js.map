{
  "version": 3,
  "sources": ["../../@zero65tech/track/src/index.js"],
  "sourcesContent": ["const _ = require('lodash');\nconst Obj = require('@zero65tech/object');\n\n\n\nexports.bookId = (name) => {\n  return '#' + name;\n}\n\nexports.headId = (name) => {\n  name = name.replaceAll(' · ', '#');\n  name = name.replaceAll(' ', '-');\n  return '#' + name;\n}\n\nexports.tagId = (name) => {\n  name = name.replaceAll(' · ', '#');\n  name = name.replaceAll(' ', '-');\n  return '#' + name;\n}\n\nexports.sourceId = (name) => {\n  return '#' + name;\n}\n\nexports.folderId = (path) => {\n  path = path.substring(0, path.length - 5);\n  path = path.replaceAll('/', '-');\n  path = path.toLowerCase();\n  return '#' + path;\n}\n\n\n\nexports.types = [\n\n  { id:'credit',   name:'Credit'   },\n  { id:'debit',    name:'Debit'    },\n  { id:'income',   name:'Income'   },\n  { id:'expense',  name:'Expense'  },\n  { id:'refund',   name:'Refund'   },\n  { id:'tax',      name:'Tax'      },\n\n  { id:'relocate', name:'Relocate' },\n\n  { id:'payment',  name:'Payment'  },\n  { id:'receipt',  name:'Receipt'  },\n\n  { id:'transfer', name:'Transfer' },\n\n];\n\n\n\nexports.seq = () => { \n  return Math.round((Date.now() - new Date('2024-04-01 GMT').getTime())/1000);\n}\n\n\n\nexports.summary = (entryGroups) => {\n\n  let summary = {};\n\n  for(let entryGroup of entryGroups) {\n    for(let entry of entryGroup.entries) {\n\n      if(entry.bookId) {\n        let amount = entry.amount;\n        if(entry.type == 'debit' || entry.type == 'expense' || entry.type == 'tax')\n          amount = -amount;\n        Obj.addAt(summary, [ 'books', entry.bookId, entry.date.substring(0,7), entry.type, entry.tagId, entry.headId ], amount);\n      } else if(entry.type == 'relocate') {\n        Obj.addAt(summary, [ 'books', entry.bookToId,   entry.date.substring(0,7), entry.type, entry.bookFromId ],  entry.amount);\n        Obj.addAt(summary, [ 'books', entry.bookFromId, entry.date.substring(0,7), entry.type, entry.bookToId   ], -entry.amount);\n      }\n\n      if(entry.sourceId) {\n        let amount = entry.amount;\n        if(entry.type == 'debit' || entry.type == 'expense' || entry.type == 'tax' || entry.type == 'payment')\n          amount = -amount;\n        Obj.addAt(summary, [ 'sources', entry.sourceId, entry.date.substring(0,7) ], amount);\n      } else if(entry.type == 'transfer') {\n        Obj.addAt(summary, [ 'sources', entry.sourceToId,   entry.date.substring(0,7) ],  entry.amount);\n        Obj.addAt(summary, [ 'sources', entry.sourceFromId, entry.date.substring(0,7) ], -entry.amount);\n      }\n\n    }\n  }\n\n  return summary;\n\n}\n"],
  "mappings": "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",
  "names": ["require_src"]
}
